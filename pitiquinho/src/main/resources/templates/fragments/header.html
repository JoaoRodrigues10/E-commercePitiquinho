<link href="https://fonts.googleapis.com/css2?family=Fredoka+One&display=swap" rel="stylesheet">

<div class="header-wrapper" th:fragment="header">
    <nav class="header-navbar">
        <div class="header-container">

            <!-- ESQUERDA: LOGO + ENDEREÇO -->
            <div class="header-left">
                <a class="header-logo d-flex align-items-center" href="/">
                    <svg xmlns="http://www.w3.org/2000/svg" width="40" height="40" viewBox="0 0 64 64">
                        <circle cx="32" cy="32" r="20" fill="#4FC3C8"/>
                        <circle cx="14" cy="14" r="8" fill="#4FC3C8"/>
                        <circle cx="50" cy="14" r="8" fill="#4FC3C8"/>
                        <circle cx="24" cy="30" r="3" fill="#fff"/>
                        <circle cx="40" cy="30" r="3" fill="#fff"/>
                        <circle cx="24" cy="30" r="1.5" fill="#333"/>
                        <circle cx="40" cy="30" r="1.5" fill="#333"/>
                        <circle cx="32" cy="38" r="2.5" fill="#333"/>
                        <path d="M28 42 Q32 46 36 42" stroke="#333" stroke-width="1.5" fill="none"/>
                    </svg>
                    <span class="header-logo-text ms-2">Pitiquinho</span>
                </a>

                <div th:if="${usuario != null and enderecoUsuario != null}" class="header-endereco">
                    <i class="fas fa-map-marker-alt me-1"></i>
                    <span th:text="'Entrega em: ' + ${enderecoUsuario.logradouro} + ', ' + ${enderecoUsuario.numero}">
                    </span>
                </div>
            </div>

            <!-- CENTRO: PESQUISA -->
            <form class="header-search" th:action="@{/produtos}" method="get">
                <input type="text" name="nome" class="header-search-input"
                       placeholder="Buscar produtos..." th:value="${nome}">
                <select name="categoria" class="header-search-select">
                    <option value="">Todas as Categorias</option>
                    <option value="Vestuário" th:selected="${selectedCategoria == 'Vestuário'}">Vestuário</option>
                    <option value="Acessórios de Passeio" th:selected="${selectedCategoria == 'Acessórios de Passeio'}">Acessórios de Passeio</option>
                    <option value="Higiene e Cuidado" th:selected="${selectedCategoria == 'Higiene e Cuidado'}">Higiene e Cuidado</option>
                    <option value="Brinquedos" th:selected="${selectedCategoria == 'Brinquedos'}">Brinquedos</option>
                    <option value="Móveis e Decoração" th:selected="${selectedCategoria == 'Móveis e Decoração'}">Móveis e Decoração</option>
                    <option value="Fraldas e Descartáveis" th:selected="${selectedCategoria == 'Fraldas e Descartáveis'}">Fraldas e Descartáveis</option>
                    <option value="Chupetas e Mordedores" th:selected="${selectedCategoria == 'Chupetas e Mordedores'}">Chupetas e Mordedores</option>
                    <option value="Livros Infantis" th:selected="${selectedCategoria == 'Livros Infantis'}">Livros Infantis</option>
                    <option value="Carrinhos e Cadeiras de Bebê" th:selected="${selectedCategoria == 'Carrinhos e Cadeiras de Bebê'}">Carrinhos e Cadeiras de Bebê</option>
                </select>
                <button type="submit" class="header-search-btn">
                    <i class="fas fa-search"></i>
                </button>
            </form>

            <!-- DIREITA: USUÁRIO + CARRINHO -->
            <div class="header-right">
                <!-- Usuário não logado -->
                <div th:if="${usuario == null or usuario.nome == null}">
                    <a href="/login" class="header-btn-login">
                        <i class="fas fa-sign-in-alt me-2"></i>Entrar
                    </a>
                </div>

                <!-- Usuário logado -->
                <div class="dropdown" th:if="${usuario != null and usuario.nome != null}">
                    <a class="header-btn-user dropdown-toggle" href="#" id="perfilDropdown" data-bs-toggle="dropdown">
                        <i class="fas fa-user me-2"></i>
                        <span th:text="${#strings.arraySplit(usuario.nome, ' ')[0]}"></span>
                    </a>
                    <ul class="dropdown-menu">
                        <li><a th:href="@{/usuario/editar}" class="dropdown-item">Meu Perfil</a></li>
                        <li><a th:href="@{/pedidos/meus-pedidos}" class="dropdown-item">Meus Pedidos</a></li>
                        <li><a th:href="@{/endereco/listar}" class="dropdown-item">Meus Endereços</a></li>
                        <li><a th:href="@{/cartoes}" class="dropdown-item">Meus Cartões</a></li>

                        <li><hr class="dropdown-divider"></li>
                        <li><a href="/logout" class="dropdown-item text-danger">Sair</a></li>
                    </ul>
                </div>

                <a href="/carrinho" class="header-cart">
                    <i class="fas fa-shopping-cart"></i>
                    <span class="ms-1">Carrinho</span>
                    <span id="quantidadeCarrinho" class="header-cart-badge ms-1">0</span>
                </a>
            </div>


        </div>
    </nav>
</div>
